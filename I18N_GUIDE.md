# å›½é™…åŒ– (i18n) ä½¿ç”¨æŒ‡å—

## æ¦‚è¿°

æœ¬é¡¹ç›®ä½¿ç”¨ `i18n-js` åº“å®ç°å›½é™…åŒ–æ”¯æŒï¼Œæä¾›ä¸­æ–‡å’Œè‹±æ–‡ä¸¤ç§è¯­è¨€ã€‚ç³»ç»Ÿä¼šè‡ªåŠ¨æ£€æµ‹æ“ä½œç³»ç»Ÿè¯­è¨€å¹¶è®¾ç½®ç›¸åº”çš„ç•Œé¢è¯­è¨€ã€‚

## ç›®å½•ç»“æ„

```
â”œâ”€â”€ locales/                    # è¯­è¨€æ–‡ä»¶ç›®å½•
â”‚   â”œâ”€â”€ zh-CN.json             # ä¸­æ–‡ç¿»è¯‘
â”‚   â””â”€â”€ en-US.json             # è‹±æ–‡ç¿»è¯‘
â”œâ”€â”€ utils/
â”‚   â”œâ”€â”€ i18nManager.js         # å›½é™…åŒ–ç®¡ç†å™¨
â”‚   â””â”€â”€ macMenuManager.js      # Mac èœå•ç®¡ç†å™¨ (æ”¯æŒå›½é™…åŒ–)
â””â”€â”€ main.js                    # åº”ç”¨å…¥å£ (é›†æˆå›½é™…åŒ–)
```

## ç‰¹æ€§

### ğŸŒ å¤šè¯­è¨€æ”¯æŒ
- **ä¸­æ–‡ (zh-CN)**: ç®€ä½“ä¸­æ–‡ç•Œé¢
- **è‹±æ–‡ (en-US)**: è‹±æ–‡ç•Œé¢
- **è‡ªåŠ¨æ£€æµ‹**: æ ¹æ®ç³»ç»Ÿè¯­è¨€è‡ªåŠ¨é€‰æ‹©ç•Œé¢è¯­è¨€
- **åŠ¨æ€åˆ‡æ¢**: æ”¯æŒè¿è¡Œæ—¶åˆ‡æ¢è¯­è¨€

### ğŸ Mac èœå•å›½é™…åŒ–
- **å®Œæ•´èœå•æ **: åº”ç”¨èœå•ã€æ–‡ä»¶ã€ç¼–è¾‘ã€è§†å›¾ã€çª—å£ã€å¸®åŠ©
- **åŠ¨æ€æ›´æ–°**: è¯­è¨€åˆ‡æ¢æ—¶èœå•å®æ—¶æ›´æ–°
- **å¿«æ·é”®æ”¯æŒ**: æ‰€æœ‰èœå•é¡¹éƒ½æ”¯æŒæ ‡å‡† Mac å¿«æ·é”®
- **è¯­è¨€é€‰æ‹©**: èœå•æ ä¸­æä¾›è¯­è¨€åˆ‡æ¢é€‰é¡¹

### ğŸ”§ å¼€å‘è€…å‹å¥½
- **å‚æ•°æ’å€¼**: æ”¯æŒ `%{variable}` æ ¼å¼çš„å˜é‡æ›¿æ¢
- **å›é€€æœºåˆ¶**: ç¼ºå¤±ç¿»è¯‘æ—¶è‡ªåŠ¨å›é€€åˆ°é»˜è®¤è¯­è¨€
- **é”™è¯¯å¤„ç†**: å®Œå–„çš„é”™è¯¯å¤„ç†å’Œæ—¥å¿—è®°å½•

## API ä½¿ç”¨

### åŸºæœ¬ç”¨æ³•

```javascript
const i18n = require('./utils/i18nManager');

// è·å–ç¿»è¯‘
const appName = i18n.t('app.name');
const menuFile = i18n.t('menu.file');

// å¸¦å‚æ•°çš„ç¿»è¯‘
const version = i18n.t('app.version', { version: '1.0.0' });
const quit = i18n.t('menu.quit', { appName: 'My App' });
```

### è¯­è¨€ç®¡ç†

```javascript
// è·å–å½“å‰è¯­è¨€
const currentLang = i18n.getCurrentLanguage(); // 'zh-CN' æˆ– 'en-US'

// åˆ‡æ¢è¯­è¨€
i18n.setLanguage('en-US');

// è·å–å¯ç”¨è¯­è¨€åˆ—è¡¨
const languages = i18n.getAvailableLanguages(); // ['zh-CN', 'en-US']

// è·å–è¯­è¨€æ˜¾ç¤ºåç§°
const displayName = i18n.getLanguageDisplayName('zh-CN'); // 'ä¸­æ–‡'
```

### äº‹ä»¶ç›‘å¬

```javascript
// ç›‘å¬è¯­è¨€å˜æ›´äº‹ä»¶
i18n.on('languageChanged', (newLang, oldLang) => {
  console.log(`è¯­è¨€å·²ä» ${oldLang} åˆ‡æ¢åˆ° ${newLang}`);
  // æ›´æ–°ç•Œé¢...
});
```

## ç¿»è¯‘æ–‡ä»¶æ ¼å¼

### ä¸­æ–‡ (locales/zh-CN.json)
```json
{
  "app": {
    "name": "SDUT OJ ç«èµ›å®¢æˆ·ç«¯",
    "version": "ç‰ˆæœ¬ %{version}"
  },
  "menu": {
    "file": "æ–‡ä»¶",
    "edit": "ç¼–è¾‘",
    "quit": "é€€å‡º %{appName}"
  }
}
```

### è‹±æ–‡ (locales/en-US.json)
```json
{
  "app": {
    "name": "SDUT OJ Competition Client",
    "version": "Version %{version}"
  },
  "menu": {
    "file": "File",
    "edit": "Edit",
    "quit": "Quit %{appName}"
  }
}
```

## Mac èœå•é›†æˆ

### è‡ªåŠ¨åˆå§‹åŒ–
åœ¨ `main.js` ä¸­ï¼ŒMac èœå•ç®¡ç†å™¨ä¼šåœ¨ macOS å¹³å°è‡ªåŠ¨åˆå§‹åŒ–ï¼š

```javascript
// macOS ç‰¹å®šè®¾ç½®
if (process.platform === 'darwin') {
  macMenuManager = new MacMenuManager(mainWindow);
}
```

### è¯­è¨€åˆ‡æ¢èœå•
èœå•æ ä¼šè‡ªåŠ¨æ·»åŠ è¯­è¨€åˆ‡æ¢é€‰é¡¹ï¼š
- **åº”ç”¨èœå• > è¯­è¨€ > ä¸­æ–‡** - åˆ‡æ¢åˆ°ä¸­æ–‡
- **åº”ç”¨èœå• > è¯­è¨€ > English** - åˆ‡æ¢åˆ°è‹±æ–‡

### å¿«æ·é”®æ”¯æŒ
æ‰€æœ‰èœå•é¡¹éƒ½æ”¯æŒæ ‡å‡† Mac å¿«æ·é”®ï¼š
- `Cmd+Q` - é€€å‡ºåº”ç”¨
- `Cmd+W` - å…³é—­çª—å£
- `Cmd+Z` - æ’¤é”€
- `Cmd+C` - å¤åˆ¶
- `Cmd+V` - ç²˜è´´
- `Cmd+Left` - åé€€
- `Cmd+Right` - å‰è¿›
- `Cmd+R` - åˆ·æ–°
- `Cmd+Shift+H` - ä¸»é¡µ

## æ·»åŠ æ–°è¯­è¨€

### 1. åˆ›å»ºè¯­è¨€æ–‡ä»¶
åœ¨ `locales/` ç›®å½•ä¸‹åˆ›å»ºæ–°çš„è¯­è¨€æ–‡ä»¶ï¼Œå¦‚ `ja-JP.json` (æ—¥è¯­)ï¼š

```json
{
  "app": {
    "name": "SDUTã‚ªãƒ³ãƒ©ã‚¤ãƒ³ã‚¸ãƒ£ãƒƒã‚¸ç«¶æŠ€ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆ"
  },
  "menu": {
    "file": "ãƒ•ã‚¡ã‚¤ãƒ«",
    "edit": "ç·¨é›†"
  }
}
```

### 2. æ›´æ–°é…ç½®
åœ¨ `utils/i18nManager.js` ä¸­æ·»åŠ æ–°è¯­è¨€ï¼š

```javascript
this.availableLanguages = ['zh-CN', 'en-US', 'ja-JP'];
```

### 3. æ·»åŠ æ˜¾ç¤ºåç§°
æ›´æ–° `getLanguageDisplayName` æ–¹æ³•ï¼š

```javascript
getLanguageDisplayName(language) {
  const displayNames = {
    'zh-CN': 'ä¸­æ–‡',
    'en-US': 'English',
    'ja-JP': 'æ—¥æœ¬èª'
  };
  return displayNames[language] || language;
}
```

## æœ€ä½³å®è·µ

### 1. ç¿»è¯‘é”®å‘½å
- ä½¿ç”¨ç‚¹åˆ†å‰²çš„å±‚çº§ç»“æ„ï¼š`app.name`, `menu.file.open`
- ä½¿ç”¨æè¿°æ€§çš„é”®åï¼š`dialog.confirm.delete` è€Œä¸æ˜¯ `dialog1`
- ä¿æŒä¸€è‡´çš„å‘½åé£æ ¼

### 2. å‚æ•°ä½¿ç”¨
- ä½¿ç”¨ `%{variable}` æ ¼å¼ï¼š`"Hello %{name}"`
- å‚æ•°åè¦æœ‰æ„ä¹‰ï¼š`%{appName}` è€Œä¸æ˜¯ `%{arg1}`
- è€ƒè™‘ä¸åŒè¯­è¨€çš„è¯­æ³•å·®å¼‚

### 3. é”™è¯¯å¤„ç†
- å§‹ç»ˆæä¾›å›é€€æ–‡æœ¬
- æ£€æŸ¥ç¿»è¯‘é”®çš„å­˜åœ¨æ€§
- å¤„ç†å‚æ•°ç¼ºå¤±çš„æƒ…å†µ

### 4. æ€§èƒ½ä¼˜åŒ–
- ä¸€æ¬¡æ€§åŠ è½½æ‰€æœ‰è¯­è¨€æ–‡ä»¶
- ç¼“å­˜ç¿»è¯‘ç»“æœ
- é¿å…é¢‘ç¹çš„è¯­è¨€åˆ‡æ¢

## æ•…éšœæ’é™¤

### å¸¸è§é—®é¢˜

1. **ç¿»è¯‘ä¸æ˜¾ç¤º**
   - æ£€æŸ¥è¯­è¨€æ–‡ä»¶æ˜¯å¦å­˜åœ¨äº `locales/` ç›®å½•
   - ç¡®è®¤ç¿»è¯‘é”®çš„æ‹¼å†™æ˜¯å¦æ­£ç¡®
   - æŸ¥çœ‹æ§åˆ¶å°æ˜¯å¦æœ‰é”™è¯¯ä¿¡æ¯

2. **èœå•æœªæ›´æ–°**
   - ç¡®è®¤åœ¨ macOS å¹³å°è¿è¡Œ
   - æ£€æŸ¥ `MacMenuManager` æ˜¯å¦æ­£ç¡®åˆå§‹åŒ–
   - éªŒè¯è¯­è¨€å˜æ›´äº‹ä»¶æ˜¯å¦è§¦å‘

3. **å‚æ•°æ’å€¼å¤±è´¥**
   - æ£€æŸ¥å‚æ•°æ ¼å¼æ˜¯å¦ä¸º `%{paramName}`
   - ç¡®è®¤ä¼ é€’çš„å‚æ•°å¯¹è±¡åŒ…å«æ‰€éœ€çš„é”®
   - éªŒè¯å‚æ•°å€¼ä¸ä¸º `undefined`

### è°ƒè¯•æŠ€å·§

```javascript
// å¯ç”¨è¯¦ç»†æ—¥å¿—
console.log('å½“å‰è¯­è¨€:', i18n.getCurrentLanguage());
console.log('å¯ç”¨è¯­è¨€:', i18n.getAvailableLanguages());

// æ£€æŸ¥ç¿»è¯‘é”®å­˜åœ¨æ€§
if (!i18n.exists('some.key')) {
  console.warn('ç¿»è¯‘é”®ä¸å­˜åœ¨:', 'some.key');
}

// ç›‘å¬è¯­è¨€å˜æ›´
i18n.on('languageChanged', (newLang, oldLang) => {
  console.log('è¯­è¨€å˜æ›´:', oldLang, '->', newLang);
});
```

## ç‰ˆæœ¬å…¼å®¹æ€§

- **Node.js**: >= 16.0.0
- **Electron**: >= 27.0.0
- **i18n-js**: ^4.5.1
